title: Orchestration Plan
schemaVersion: 2.0
description: 'Template for plans/PLAN.md files generated by orchestrated multi-agent systems. Supports subagent task assignment, parallel execution groups, and spec-driven lifecycle.'

## Planning Prompt
Track orchestrated multi-agent workflow execution through phases and tasks with quality gates, spec-driven lifecycle, and state tracking. Each task identifies which subagent owns it and whether it can run in parallel with other tasks. Update this plan as tasks complete and quality gates are evaluated.

## 1. Summary
- **Project**: [Project name and goal]
- **System**: [System name] ([Orchestra | Atlas | Pipeline | Custom] pattern)
- **Conductor**: [Conductor agent name]
- **Subagents**: [Comma-separated list of subagent names]
- **Spec Enforcement**: [full | lightweight | none]
- **Parallel Execution**: [true | false]

## 2. Subagent Registry

| Agent | Role | Model Tier | Tools | Scope |
|-------|------|------------|-------|-------|
| [Conductor] | Orchestrates phases, manages gates | High | search, agent | Full project |
| [Subagent1] | [Role description] | [Tier] | [tools] | [file scope or domain] |
| [Subagent2] | [Role description] | [Tier] | [tools] | [file scope or domain] |
| [SubagentN] | [Role description] | [Tier] | [tools] | [file scope or domain] |

## 3. Phase Definitions

| Phase | Name | Owner Agent | Input | Output | Quality Gate |
|-------|------|-------------|-------|--------|-------------|
| 1 | [Phase name] | [Agent] | [What it receives] | [What it produces] | [Gate name or None] |
| 2 | [Phase name] | [Agent] | [What it receives] | [What it produces] | [Gate name or None] |
| 3 | [Phase name] | [Agent] | [What it receives] | [What it produces] | [Gate name or None] |

## 4. Task Breakdown

### Phase 1: [Phase Name]

| Task | Description | Assigned Agent | Parallel Group | Dependencies | Files Scope | Status |
|------|-------------|----------------|----------------|--------------|-------------|--------|
| 1.1 | [Task description] | [Agent name] | — | None | [glob pattern] | pending |
| 1.2 | [Task description] | [Agent name] | — | 1.1 | [glob pattern] | pending |

### Phase 2: [Phase Name]

| Task | Description | Assigned Agent | Parallel Group | Dependencies | Files Scope | Status |
|------|-------------|----------------|----------------|--------------|-------------|--------|
| 2.1 | [Task description] | [Agent name] | **A** | Phase 1 | [glob pattern] | pending |
| 2.2 | [Task description] | [Agent name] | **A** | Phase 1 | [glob pattern] | pending |
| 2.3 | [Task description] | [Agent name] | **B** | 2.1, 2.2 | [glob pattern] | pending |

> **Parallel Group column**: Tasks sharing the same group letter (A, B, C...) run concurrently.
> Tasks with `—` run sequentially. Tasks in different groups run after their dependencies complete.

### Phase 3: [Phase Name]

| Task | Description | Assigned Agent | Parallel Group | Dependencies | Files Scope | Status |
|------|-------------|----------------|----------------|--------------|-------------|--------|
| 3.1 | [Task description] | [Agent name] | — | Phase 2 | [glob pattern] | pending |

## 5. Parallel Execution Map

### Execution Flow
```
Phase 1 (sequential):
  Task 1.1 [Agent] → Task 1.2 [Agent]

Phase 2 (mixed):
  ┌─ Task 2.1 [Agent] ─┐
  │  (Group A)          │── sync ──→ Task 2.3 [Agent]
  └─ Task 2.2 [Agent] ─┘
     (Group A)

Phase 3 (sequential):
  Task 3.1 [Agent]
```

### Parallel Group Rules
| Group | Tasks | Agents | Files Scope (must be disjoint) | Sync Point |
|-------|-------|--------|-------------------------------|------------|
| [A] | [2.1, 2.2] | [Agent-1, Agent-2] | [disjoint glob patterns] | Before task [2.3] |
| [B] | [task list] | [agent list] | [disjoint glob patterns] | Before [gate/task] |

## 6. Quality Gates

### Gate 1: [Gate Name]
- **After Phase**: [phase number]
- **Criteria**:
  - [ ] [Criterion 1]
  - [ ] [Criterion 2]
  - [ ] [Criterion 3]
- **Outcomes**: APPROVED → proceed | NEEDS_REVISION → return to phase | FAILED → escalate
- **Result**: [pending]

### Gate 2: [Gate Name]
- **After Phase**: [phase number]
- **Criteria**:
  - [ ] [Criterion 1]
  - [ ] [Criterion 2]
- **Outcomes**: APPROVED → proceed | NEEDS_REVISION → return to phase | FAILED → escalate
- **Result**: [pending]

### Gate 3: [Gate Name]
- **After Phase**: [phase number]
- **Criteria**:
  - [ ] [Criterion 1]
  - [ ] [Criterion 2]
- **Outcomes**: APPROVED → proceed | FAILED → block commit
- **Result**: [pending]

## 7. Spec-Driven Lifecycle

### Per-Phase Spec Requirements
For each implementation phase (when spec enforcement = full):

| Step | Action | Agent | Verification |
|------|--------|-------|-------------|
| Spec | Define requirements, acceptance criteria, and agent-task assignments | Planner | Documented in this plan with tasks assigned to agents |
| Implement | Build changes following spec, per agent-task assignment | Assigned agents (see Task Breakdown) | Changes match spec, file scopes respected |
| Validate | Verify implementation against spec criteria | Reviewer / Conductor | Validation report generated |
| Review | Quality, correctness, and cross-agent integration review | Reviewer | Review report generated |
| Commit | Stage and commit changes | Conductor | PLAN.md updated, task statuses marked complete |

## 8. State Tracking

- **Current Phase**: [phase name or "Not started"]
- **Current Task**: [task ID or "None"]
- **Active Agent**: [agent name or "None"]
- **Active Parallel Group**: [group letter or "None"]
- **Status**: [NOT_STARTED | IN_PROGRESS | BLOCKED | AWAITING_APPROVAL | COMPLETED]
- **Completed Phases**: [list]
- **Completed Tasks**: [list of task IDs]
- **Blocking Issues**: [list or "None"]
- **Next Action**: [description]

## 9. Progress Log

| Timestamp | Phase | Task | Event | Agent | Details |
|-----------|-------|------|-------|-------|---------|
| [datetime] | — | — | System initialized | Conductor | Awaiting start |

## 10. Parallel Execution Plan (Atlas pattern)

## 7b. Pipeline Stages (Pipeline pattern only)

### Shared Agent Pool Manifest
| Specialist | Role | Model Tier | Tools |
|------------|------|------------|-------|
| [Specialist1] | [Role description] | [High/Medium/Low] | [tools list] |
| [Specialist2] | [Role description] | [High/Medium/Low] | [tools list] |

### Stage Definitions
| Stage | Name | Sub-Orchestrator | Typical Specialists | Inter-Stage Gate |
|-------|------|------------------|---------------------|------------------|
| 1 | [Stage name] | [Sub-orchestrator agent] | [Specialists typically used] | [Gate name or None] |
| 2 | [Stage name] | [Sub-orchestrator agent] | [Specialists typically used] | [Gate name after this stage] |
| 3 | [Stage name] | [Sub-orchestrator agent] | [Specialists typically used] | [Gate name after this stage] |
| 4 | [Stage name] | [Sub-orchestrator agent] | [Specialists typically used] | [Gate name after this stage] |

### Inter-Stage Quality Gates

#### Gate: [Stage A] → [Stage B]
- **After Stage**: [stage name]
- **Sub-Orchestrator**: [orchestrator that completed]
- **Criteria**:
  - [ ] [Criterion 1]
  - [ ] [Criterion 2]
- **Outcomes**: APPROVED → advance | NEEDS_REVISION → re-run stage | FAILED → escalate
- **Result**: [pending]

### Stage-Level State Tracking
- **Current Stage**: [stage name or "Not started"]
- **Current Stage Status**: [NOT_STARTED | IN_PROGRESS | BLOCKED | AWAITING_GATE | COMPLETED]
- **Completed Stages**: [list]
- **Active Sub-Orchestrator**: [name or "None"]
- **Next Stage**: [stage name]

### Pluggable Stage Insertion Point
To add a new stage, insert a row in the Stage Definitions table and define:
- Sub-orchestrator agent file (with `agents` array listing ALL shared specialists)
- Inter-stage quality gate criteria
- Pipeline Controller handoff entry

## 11. Final Report (generated on completion)

### Completion Summary
- **Total Phases**: [count]
- **Total Tasks**: [count]
- **Tasks Run in Parallel**: [count]
- **Quality Gates Passed**: [count]/[total]
- **Spec Compliance**: [criteria defined], [criteria validated]
- **Files Created/Modified**: [count]
- **Duration**: [total time]

### Agent Contribution Summary
| Agent | Tasks Completed | Files Modified | Parallel Groups |
|-------|----------------|----------------|-----------------|
| [Agent1] | [count] | [count] | [groups participated in] |
| [Agent2] | [count] | [count] | [groups participated in] |

### Artifacts
| File | Action | Task | Agent |
|------|--------|------|-------|
| [file path] | [created | modified] | [task ID] | [agent that made the change] |

---

### Template Notes
**Version**: Orchestration plan template v2.0
**Usage**: Generated by conductor agents for tracking orchestrated multi-agent workflows
**Key features**: Subagent task assignment, parallel execution groups, spec-driven lifecycle
**Companion**: Use with orchestration skill methodology
